## 로더(Loader)

로더(Loader)는 JavaScript가 아닌 파일(CSS, 이미지, TypeScript 등)을 JavaScript 모듈로 변환해 번들러가 경로 탐색 과정에서 읽고 연결할 수 있도록 만들어주는 도구예요.

경로 탐색은 `import`나 `require` 구문을 따라 필요한 파일을 찾아가는 과정인데, 이때 파일이 JavaScript 모듈이 아니라면 번들러가 읽거나 연결할 수 없어요. 그래서 CSS, 이미지, TypeScript 파일처럼 브라우저가 바로 해석할 수 없는 리소스는 로더를 통해 JavaScript 모듈로 변환해주어야, 다른 모듈처럼 경로 탐색을 이어갈 수 있어요.

예를 들어, 다음과 같이 JavaScript 파일에서 CSS를 `import`하는 코드를 작성해본 경험이 있을 거예요.

```jsx
// Main.tsx
import './main.css';

export function Main() {
  return <div>hello!!</div>;
}
```

코드상으로는 문제가 없어 보이지만, 번들러는 기본적으로 JavaScript만 해석할 수 있기 때문에 `.css` 파일을 처리하지 못하고 다음과 같은 에러가 발생해요.

```
Module parse failed: Unexpected token (1:5)
You may need an appropriate loader to handle this file type,
currently no loaders are configured to process this file.
```

이 문제를 해결하려면 번들러가 CSS 파일을 처리할 수 있도록 `css-loader`를 추가해야 해요.

```js
// webpack.config.js
module.exports = {
  //...
  rules: [
    {
      test: /\.css$/,
      use: 'css-loader',
    },
  ],
};
```

## 주요 로더

리액트 프로젝트를 구성할 때 자주 사용하는 로더를 소개해요.

### babel-loader

최신 JavaScript, TypeScript, JSX를 구형 브라우저에서도 동작하는 JavaScript로 변환하는 로더예요.

- JSX 변환: React의 JSX 문법을 브라우저가 이해할 수 있는 JavaScript로 변환
- JavaScript 변환: 최신 JavaScript 문법을 구형 브라우저에서 실행 가능한 코드로 변환
- TypeScript 변환: TypeScript 코드를 JavaScript로 변환

```js
// webpack.config.js
module.exports = {
  //...
  rules: [
    {
      test: /\.(js|jsx)$/,
      use: {
        loader: 'babel-loader',
        options: {
          presets: [
            '@babel/preset-env',
            '@babel/preset-react',
            '@babel/preset-typescript',
          ],
        },
      },
    },
  ],
};
```

### css-loader & style-loader

`css-loader`는 CSS 파일을 웹팩이 처리할 수 있도록 변환하는 로더예요. 로더를 사용하면 JavaScript에서 CSS 파일을 `import`하여 사용할 수 있어요.

`style-loader`는 `css-loader`로 변환된 JavaScript 모듈을 DOM의 `<style>` 태그에 삽입해 스타일을 적용하는 로더예요.

### file-loader

이미지, 폰트 같은 정적 파일을 웹팩이 번들링할 수 있도록 파일로 저장하고, URL로 변환하는 로더예요. 이렇게 변환된 URL을 JavaScript 코드에서 `import`하여 사용할 수 있어요.

```js
// webpack.config.js
module.exports = {
  //...
  rules: [
    {
      test: /\.(png|svg|jpg|jpeg|gif)$/i,
      use: [
        {
          loader: 'file-loader',
          options: {
            name: '[path][name].[ext]',
          },
        },
      ],
    },
  ],
};
```

````참고
정적 리소스의 타입 오류 방지하기

이미지, 폰트 같은 정적 파일을 `import`하면 타입 오류가 발생할 수 있어요. 이를 방지하려면 해당 파일 확장자에 대한 타입 정의를 추가해야 해요.

```ts
// global.d.ts
declare module '*.svg' {
  const value: string;
  export default value;
}
````

그리고 `tsconfig.json`의 `include` 항목에 타입을 정의해주면 돼요.

```json
// tsconfig.json
{
  "include": ["global.d.ts"]
}
```

````

## 로더 설정

웹팩에서 로더를 설정할 때는 파일 확장자별로 어떤 로더를 사용할지 지정해야 해요. 이 설정을 기반으로 웹팩은 번들링 전에 파일 확장자를 확인하고, 해당 파일에 적절한 로더를 적용해 변환할 수 있어요.

### 확장자 검사하기: test

`test`는 어떤 파일에 로더를 적용할지 확장자로 지정하는 옵션이에요.

```js
module.exports = {
  module: {
    rules: [
      {
        test: /\.css$/, // .css 확장자에만 적용
        use: 'css-loader', // css-loader 사용
      },
    ],
  },
};
````

### 사용할 로더 지정: use

`use` 옵션은 해당 파일을 처리할 로더를 지정하는 역할을 해요.

하나의 파일에 여러 로더를 사용해야 할 때는, `use` 옵션을 배열로 지정하면 돼요. 이때 배열의 오른쪽에서 왼쪽 순서로 로더가 실행되기 때문에 실행 순서를 올바르게 지정해야 해요.

```js
rules: [
  {
    test: /\.css$/,
    use: ['style-loader', 'css-loader'],
  },
];
```

### 제외할 파일 지정하기: exclude

`exclude`는 로더가 처리하지 않을 파일이나 디렉토리를 지정하는 옵션이에요. 주로 외부 라이브러리 폴더인 `node_modules`를 제외할 때 많이 사용해요.

```js
module.exports = {
  module: {
    rules: [
      {
        test: /\.js$/,
        exclude: /node_modules/,
        use: 'babel-loader',
      },
    ],
  },
};
```

### 적용할 파일 지정하기: include

`include`는 로더를 적용할 파일이나 디렉토리를 지정하는 옵션이에요.

```js
module.exports = {
  module: {
    rules: [
      {
        test: /\.js$/,
        include: path.resolve(__dirname, 'src'),
        use: 'babel-loader',
      },
    ],
  },
};
```

## 다음 단계

로더를 이해했다면, 이제 번들링 과정을 더 유연하게 제어하는 방법을 알아볼 차례예요. 다음 문서에서는 플러그인(Plugin)에 대해 배워볼게요.
